-- 运维巡检：24 小时内“没有任何上报”的传感器清单
SELECT
  r.`区域编号`, r.`区域名称`, r.`区域类型`,
  r.`负责人ID`,
  s.`传感器编号`, s.`设备型号`, s.`监测类型`, s.`通信协议`, s.`安装时间`,
  MAX(d.`数据采集时间`) AS `最近上报时间`
FROM `区域` r
JOIN `传感器` s ON s.`区域编号` = r.`区域编号`
LEFT JOIN `监测数据` d ON d.`传感器编号` = s.`传感器编号`
GROUP BY
  r.`区域编号`, r.`区域名称`, r.`区域类型`, r.`负责人ID`,
  s.`传感器编号`, s.`设备型号`, s.`监测类型`, s.`通信协议`, s.`安装时间`
HAVING `最近上报时间` IS NULL
    OR `最近上报时间` < NOW() - INTERVAL 24 HOUR
ORDER BY r.`区域编号`, s.`监测类型`, s.`传感器编号`;
